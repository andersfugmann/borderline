# Test protocol definitions to ensure no name clash
import "../configuration/generic/l4proto.bl"

# All ip addresses are gone.
#
process filter {
        rule {
             source interface = ["e1", "e2", "e3", "e4"];
             address family = ipv6;
             #protocol = [ ipv6-icmp ]; #58
             rule {
                  source interface = "e1";
                  icmp6 = [ 1,2 ];
                  hoplimit != 255;
              } policy { log "OK: e1 - hoplimit only works for ipv6"; accept };
             rule {
                 source interface = "e2";
                 source address = 1.1.1.3
             } policy { log "ERROR: e2 - ipv4 kept"; reject };
             rule {
                 source interface = "e3";
                 source address = 1::1
             } policy { log "OK: e3 - ipv6 kept"; accept };
             source interface = "e4";
        } policy { log "OK: e4 - No conflict on rules ipv6"; accept };
} policy deny
